{% extends "base.html" %}

{% block title %}Dex - Perfil{% endblock %}

{% block content %}
<section class="perfil-section">
  <h2>Seu Perfil</h2>
  
  <img src="{{ perfil.foto }}" alt="Avatar" class="avatar">
  
  <label for="nome">Nome:</label>
  <input type="text" id="nome" value="{{ perfil.nome }}" />
  
  <label for="bio">Biografia:</label>
  <textarea id="bio" rows="4">{{ perfil.bio }}</textarea>
  
  <button onclick="salvarPerfil()" class="btn">Salvar</button>
</section>

<script>
  async function salvarPerfil() {
    const nome = document.getElementById("nome").value.trim();
    const bio = document.getElementById("bio").value.trim();

    if (!nome) {
      alert("Por favor, insira um nome.");
      return;
    }

    const response = await fetch("/salvar_perfil", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ nome, bio })
    });

    if (response.ok) {
      alert("Perfil salvo com sucesso!");
    } else {
      alert("Erro ao salvar perfil.");
    }
  }
</script>
{% endblock %}